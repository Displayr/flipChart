tb.1d <- structure(c(`18 to 24` = 13.4556574923547, `25 to 29` = 11.9266055045872,
`30 to 34` = 10.0917431192661, `35 to 39` = 11.0091743119266,
`40 to 44` = 10.7033639143731, `45 to 49` = 8.25688073394496,
`50 to 54` = 12.2324159021407, `55 to 64` = 15.5963302752294,
`65 or more` = 6.72782874617737, NET = 100), statistic = "%", .Dim = 10L, .Dimnames = list(
    c("18 to 24", "25 to 29", "30 to 34", "35 to 39", "40 to 44",
    "45 to 49", "50 to 54", "55 to 64", "65 or more", "NET")), basedescriptiontext = "sample size = 327", basedescription = list(
    Minimum = 327L, Maximum = 327L, Range = FALSE, Total = 327L,
    Missing = 0L, EffectiveSampleSize = 327L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0, 0, 0, 0, 0, 0, 0,
    0.406169665809769, 0.246786632390746, 1), .Dim = 10L), significancedirection = structure(c("None",
    "None", "None", "None", "None", "None", "None", "Up", "Down",
    "Up"), .Dim = 10L), significancefontsizemultiplier = structure(c(1,
    1, 1, 1, 1, 1, 1, 2.58, 0.510204081632653, 4.89), .Dim = 10L),
    significanceissignificant = structure(c(FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE), .Dim = 10L),
    zstatistic = structure(c(1.34905675508496, 0.469237132203466,
    -0.586546415254331, -0.0586546415254316, -0.234618566101732,
    -1.64232996271213, 0.645201056779765, 2.58080422711906, -2.52214958559362,
    51.1468474101777), .Dim = 10L), pcorrected = structure(c(0.177318737065621,
    0.638900146627275, 0.557508379805612, 0.953227187916832,
    0.814504798068216, 0.100521640833403, 0.518796901452635,
    0.00985704625920114, 0.0116640096285578, 0), .Dim = 10L)), class = "data.frame", row.names = c(NA,
10L)), questiontypes = "PickOne", span = list(rows = structure(list(
    c("18 to 24", "25 to 29", "30 to 34", "35 to 39", "40 to 44",
    "45 to 49", "50 to 54", "55 to 64", "65 or more", "NET")), class = "data.frame", .Names = "", row.names = c(NA,
10L))), footer.html = "&lt;div data-editable=\"true\" style=\"font-family:'Open Sans', sans-serif;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;color:#505050;text-align:center;\"&gt;Age SUMMARY&lt;br /&gt;sample size = 327; 90% confidence level&lt;/div&gt;", name = "table.Age", questions = c("Age",
"SUMMARY"))

tb.1d.multstats <- structure(c(13.4556574923547, 11.9266055045872, 10.0917431192661,
11.0091743119266, 10.7033639143731, 8.25688073394496, 12.2324159021407,
15.5963302752294, 6.72782874617737, 100, 44, 39, 33, 36, 35,
27, 40, 51, 22, 327), .Dim = c(10L, 2L), .Dimnames = list(c("18 to 24",
"25 to 29", "30 to 34", "35 to 39", "40 to 44", "45 to 49", "50 to 54",
"55 to 64", "65 or more", "NET"), c("%", "Count")), basedescriptiontext = "sample size = 327", basedescription = list(
    Minimum = 327L, Maximum = 327L, Range = FALSE, Total = 327L,
    Missing = 0L, EffectiveSampleSize = 327L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0, 0, 0, 0, 0, 0, 0,
    0.406169665809769, 0.246786632390746, 1), .Dim = 10L), significancedirection = structure(c("None",
    "None", "None", "None", "None", "None", "None", "Up", "Down",
    "Up"), .Dim = 10L), significancefontsizemultiplier = structure(c(1,
    1, 1, 1, 1, 1, 1, 2.58, 0.510204081632653, 4.89), .Dim = 10L),
    significanceissignificant = structure(c(FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE), .Dim = 10L),
    zstatistic = structure(c(1.34905675508496, 0.469237132203466,
    -0.586546415254331, -0.0586546415254316, -0.234618566101732,
    -1.64232996271213, 0.645201056779765, 2.58080422711906, -2.52214958559362,
    51.1468474101777), .Dim = 10L), pcorrected = structure(c(0.177318737065621,
    0.638900146627275, 0.557508379805612, 0.953227187916832,
    0.814504798068216, 0.100521640833403, 0.518796901452635,
    0.00985704625920114, 0.0116640096285578, 0), .Dim = 10L)), class = "data.frame", row.names = c(NA,
10L)), questiontypes = "PickOne", span = list(rows = structure(list(
    c("18 to 24", "25 to 29", "30 to 34", "35 to 39", "40 to 44",
    "45 to 49", "50 to 54", "55 to 64", "65 or more", "NET")), class = "data.frame", .Names = "", row.names = c(NA,
10L))), footer.html = "&lt;div data-editable=\"true\" style=\"font-family:'Open Sans', sans-serif;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;color:#505050;text-align:center;\"&gt;Age SUMMARY&lt;br /&gt;sample size = 327; 90% confidence level&lt;/div&gt;", name = "table.Age.2", questions = c("Age",
"SUMMARY"))

tb.2d <- structure(c(19.5804195804196, 11.1888111888112, 11.8881118881119,
14.6853146853147, 6.99300699300699, 4.89510489510489, 12.5874125874126,
12.5874125874126, 5.59440559440559, 100, 2.7027027027027, 10.8108108108108,
8.10810810810811, 16.2162162162162, 21.6216216216216, 2.7027027027027,
8.10810810810811, 16.2162162162162, 13.5135135135135, 100, 6.55737704918033,
14.7540983606557, 9.83606557377049, 11.4754098360656, 9.83606557377049,
11.4754098360656, 18.0327868852459, 13.1147540983607, 4.91803278688525,
100, 10.7142857142857, 7.14285714285714, 10.7142857142857, 7.14285714285714,
21.4285714285714, 25, 3.57142857142857, 10.7142857142857, 3.57142857142857,
100, 0, 11.1111111111111, 0, 0, 11.1111111111111, 11.1111111111111,
11.1111111111111, 33.3333333333333, 22.2222222222222, 100, 15.9090909090909,
15.9090909090909, 9.09090909090909, 0, 9.09090909090909, 4.54545454545455,
11.3636363636364, 27.2727272727273, 6.81818181818182, 100, NA,
NA, NA, NA, NA, NA, NA, NA, NA, NA, 13.3540372670807, 12.111801242236,
10.2484472049689, 11.1801242236025, 10.8695652173913, 7.7639751552795,
12.111801242236, 15.527950310559, 6.83229813664596, 100), statistic = "Column %", .Dim = c(10L,
8L), .Dimnames = list(c("18 to 24", "25 to 29", "30 to 34", "35 to 39",
"40 to 44", "45 to 49", "50 to 54", "55 to 64", "65 or more",
"NET"), c("Coca-Cola", "Diet Coke", "Coke Zero", "Pepsi", "Pepsi Light",
"Pepsi Max", "Don't Know", "NET")), basedescriptiontext = "sample size = 322; total sample size = 327; 5 missing", basedescription = list(
    Minimum = 322L, Maximum = 322L, Range = FALSE, Total = 327L,
    Missing = 5L, EffectiveSampleSize = 322L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0.465295629820051, 0.246786632390746,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0.246786632390746, 0, 0, 0.246786632390746,
    0.246786632390746, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.588688946015424,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.246786632390746,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), .Dim = 80L),
    significancedirection = structure(c("Up", "Down", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "Down", "None", "None", "Down", "Up", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "Up", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "Up", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None"), .Dim = 80L), significancefontsizemultiplier = structure(c(2.81,
    0.510204081632653, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.510204081632653,
    1, 1, 0.510204081632653, 1.96, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    3.29, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1.96, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1), .Dim = 80L), significanceissignificant = structure(c(TRUE,
    TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), .Dim = 80L),
    zstatistic = structure(c(2.93578850139456, -2.02455666408337,
    -1.73335573192653, -0.429749997270421, -1.1945632448621,
    0.536230411561393, NaN, NaN, -0.453729284590561, -0.257816566715327,
    0.702561911297674, -0.843388641345339, -0.0933269319516046,
    0.830875501735228, NaN, NaN, 0.86711053340442, -0.456287879798775,
    -0.117956503946516, 0.0850586829977906, -1.02821768746239,
    -0.272469036734424, NaN, NaN, 1.78403210293349, 1.03328857450936,
    0.0812898816545514, -0.709483617405648, -1.07955619917021,
    -2.53279540692215, NaN, NaN, -1.99754536704165, 2.23346320959506,
    -0.288047315457144, 1.87861260846127, 0.0236133487764686,
    -0.407947963911125, NaN, NaN, -1.71944381886649, -1.22285151786072,
    1.20315634025446, 3.56679410704079, 0.380590564899098, -0.858609745026525,
    NaN, NaN, 0.233804031353724, -0.793409692407812, 1.57433430219498,
    -1.4495742273123, -0.0933269319516046, -0.163704095137423,
    NaN, NaN, -1.30221475467553, 0.122870900741229, -0.578031694439452,
    -0.736030023897417, 1.49594201452003, 2.31506435083048, NaN,
    NaN, -0.786930339502098, 1.71216550778161, -0.65820115769566,
    -0.715732301403764, 1.85608304390588, -0.00399426824408632,
    NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN), .Dim = 80L),
    pcorrected = structure(c(0.00332701075115771, 0.0429129079501992,
    0.0830324606376377, 0.667377509750144, 0.232257716831145,
    0.591799317853436, NaN, NaN, 0.650023686571348, 0.796548478221315,
    0.48232880618842, 0.399011122420855, 0.925643836847363, 0.406043964506214,
    NaN, NaN, 0.385881449731541, 0.648182978374414, 0.90610212202537,
    0.93221473740946, 0.303847440140233, 0.785261396048757, NaN,
    NaN, 0.0744184488015773, 0.301468872515871, 0.93521142062976,
    0.478024414342783, 0.280339855155562, 0.0113156977741127,
    NaN, NaN, 0.0457659713221304, 0.0255184138560594, 0.773310520282029,
    0.0602974082832378, 0.981161024336832, 0.683311878311257,
    NaN, NaN, 0.0855335891962504, 0.221385783046574, 0.228915826510957,
    0.000361375187724833, 0.703507083456397, 0.390555859853899,
    NaN, NaN, 0.815137119743095, 0.427539165552195, 0.115410183524363,
    0.147177287327939, 0.925643836847363, 0.869964093589981,
    NaN, NaN, 0.192842982724125, 0.902209328832379, 0.563242721205094,
    0.46171242627478, 0.134668766383024, 0.0206094106241538,
    NaN, NaN, 0.431322645882663, 0.0868661719220759, 0.510408881011984,
    0.474156661506339, 0.0634417222066936, 0.996813043510553,
    NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN), .Dim = 80L)), class = "data.frame", row.names = c(NA,
80L)), questiontypes = c("PickOne", "PickOne"), span = list(rows = structure(list(
    c("18 to 24", "25 to 29", "30 to 34", "35 to 39", "40 to 44",
    "45 to 49", "50 to 54", "55 to 64", "65 or more", "NET")), class = "data.frame", .Names = "", row.names = c(NA,
10L)), columns = structure(list(c("Coca-Cola", "Diet Coke", "Coke Zero",
"Pepsi", "Pepsi Light", "Pepsi Max", "Don't Know", "NET")), class = "data.frame", .Names = "", row.names = c(NA,
8L))), footer.html = "&lt;div data-editable=\"true\" style=\"font-family:'Open Sans', sans-serif;font-size:8pt;font-weight:normal;font-style:normal;text-decoration:none;color:#505050;text-align:center;\"&gt;Age by Preferred cola&lt;br /&gt;sample size = 322; total sample size = 327; 5 missing; 95% confidence level&lt;/div&gt;", name = "table.Age.by.Preferred.cola", questions = c("Age",
"Preferred cola [DemoData.sav]"))

tb.2d.multstats <- structure(c(28, 16, 17, 21, 10, 7, 18, 18, 8, 143, 1, 4, 3, 6,
    8, 1, 3, 6, 5, 37, 4, 9, 6, 7, 6, 7, 11, 8, 3, 61, 3, 2, 3, 2,
    6, 7, 1, 3, 1, 28, 0, 1, 0, 0, 1, 1, 1, 3, 2, 9, 7, 7, 4, 0,
    4, 2, 5, 12, 3, 44, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 43, 39, 33,
    36, 35, 25, 39, 50, 22, 322, 0.0157269422839201, 0.0121286458946727,
    0.0124814773358392, 0.0137811197741663, 0.00968208540294576,
    0.00813946591792366, 0.012822262288987, 0.012822262288987, 0.0086876322662471,
    0.0277323163918336, 0.0031055900621118, 0.0061820877857208, 0.00536225645871836,
    0.00754763306874051, 0.0086876322662471, 0.0031055900621118,
    0.00536225645871836, 0.00754763306874051, 0.00690090812338863,
    0.0177997910475804, 0.0061820877857208, 0.00919994086034448,
    0.00754763306874051, 0.00813946591792366, 0.00754763306874051,
    0.00813946591792366, 0.0101383702902309, 0.0086876322662471,
    0.00536225645871836, 0.021871410068479, 0.00536225645871836,
    0.00438512117775284, 0.00536225645871836, 0.00438512117775284,
    0.00754763306874051, 0.00813946591792366, 0.0031055900621118,
    0.00536225645871836, 0.0031055900621118, 0.0157269422839201,
    0, 0.0031055900621118, 0, 0, 0.0031055900621118, 0.0031055900621118,
    0.0031055900621118, 0.00536225645871836, 0.00438512117775284,
    0.00919994086034448, 0.00813946591792366, 0.00813946591792366,
    0.0061820877857208, 0, 0.0061820877857208, 0.00438512117775284,
    0.00690090812338863, 0.0105721442957206, 0.00536225645871836,
    0.0191708049387371, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0189857580282105,
    0.0182103013783517, 0.0169276824503943, 0.0175883815791785, 0.0173726704996052,
    0.0149361903974068, 0.0182103013783517, 0.0202144098244544, 0.0140819753534663,
    0), dim = c(10L, 8L, 2L), dimnames = list(c("18 to 24", "25 to 29",
    "30 to 34", "35 to 39", "40 to 44", "45 to 49", "50 to 54", "55 to 64",
    "65 or more", "NET"), c("Coca-Cola", "Diet Coke", "Coke Zero",
    "Pepsi", "Pepsi Light", "Pepsi Max", "Don't Know", "NET"), c("Count",
    "Standard Error")), class = c("array", "qTable", "QTable"), dimnets = list(
    10L, 8L), dimduplicates = list(10L, 8L), span = list(rows = structure(list(
    c("18 to 24", "25 to 29", "30 to 34", "35 to 39", "40 to 44",
    "45 to 49", "50 to 54", "55 to 64", "65 or more", "NET")), class = "data.frame",
    names = "", row.names = c(NA, 10L)), columns = structure(list(c("Coca-Cola",
    "Diet Coke", "Coke Zero", "Pepsi", "Pepsi Light", "Pepsi Max", "Don't Know", "NET")),
    class = "data.frame", names = "", row.names = c(NA, 8L))),
    basedescriptiontext = "sample size = 322; total sample size = 327; 5 missing",
    basedescription = list(Minimum = 322L, Maximum = 322L, Range = FALSE, Total = 327L,
    Missing = 5L, EffectiveSampleSize = 322L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0.465295629820051, 0.246786632390746,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0.246786632390746, 0, 0, 0.246786632390746,
    0.246786632390746, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.588688946015424,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.246786632390746,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), dim = 80L),
    significancedirection = structure(c("Up", "Down", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "Down", "None", "None", "Down", "Up", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "Up", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "Up", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None"), dim = 80L),
    significancefontsizemultiplier = structure(c(2.81,
    0.510204081632653, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.510204081632653,
    1, 1, 0.510204081632653, 1.96, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    3.29, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1.96, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1), dim = 80L), significanceissignificant = structure(c(TRUE,
    TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), dim = 80L),
    zstatistic = structure(c(2.93578850139456, -2.02455666408337,
    -1.73335573192653, -0.429749997270421, -1.1945632448621,
    0.536230411561393, NaN, NaN, -0.453729284590561, -0.257816566715327,
    0.702561911297674, -0.843388641345339, -0.0933269319516046,
    0.830875501735228, NaN, NaN, 0.86711053340442, -0.456287879798775,
    -0.117956503946516, 0.0850586829977906, -1.02821768746239,
    -0.272469036734424, NaN, NaN, 1.78403210293349, 1.03328857450936,
    0.0812898816545514, -0.709483617405648, -1.07955619917021,
    -2.53279540692215, NaN, NaN, -1.99754536704165, 2.23346320959506,
    -0.288047315457144, 1.87861260846127, 0.0236133487764686,
    -0.407947963911125, NaN, NaN, -1.71944381886649, -1.22285151786072,
    1.20315634025446, 3.56679410704079, 0.380590564899098, -0.858609745026525,
    NaN, NaN, 0.233804031353724, -0.793409692407812, 1.57433430219498,
    -1.4495742273123, -0.0933269319516046, -0.163704095137423,
    NaN, NaN, -1.30221475467553, 0.122870900741229, -0.578031694439452,
    -0.736030023897417, 1.49594201452003, 2.31506435083048, NaN,
    NaN, -0.786930339502098, 1.71216550778161, -0.65820115769566,
    -0.715732301403764, 1.85608304390588, -0.00399426824408632,
    NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN), dim = 80L),
    pcorrected = structure(c(0.00332701075115771, 0.0429129079501992,
    0.0830324606376377, 0.667377509750144, 0.232257716831145,
    0.591799317853436, NaN, NaN, 0.650023686571348, 0.796548478221315,
    0.48232880618842, 0.399011122420855, 0.925643836847363, 0.406043964506214,
    NaN, NaN, 0.385881449731541, 0.648182978374414, 0.90610212202537,
    0.93221473740946, 0.303847440140233, 0.785261396048757, NaN,
    NaN, 0.0744184488015773, 0.301468872515871, 0.93521142062976,
    0.478024414342783, 0.280339855155562, 0.0113156977741127,
    NaN, NaN, 0.0457659713221304, 0.0255184138560594, 0.773310520282029,
    0.0602974082832378, 0.981161024336832, 0.683311878311257,
    NaN, NaN, 0.0855335891962504, 0.221385783046574, 0.228915826510957,
    0.000361375187724833, 0.703507083456397, 0.390555859853899,
    NaN, NaN, 0.815137119743095, 0.427539165552195, 0.115410183524363,
    0.147177287327939, 0.925643836847363, 0.869964093589981,
    NaN, NaN, 0.192842982724125, 0.902209328832379, 0.563242721205094,
    0.46171242627478, 0.134668766383024, 0.0206094106241538,
    NaN, NaN, 0.431322645882663, 0.0868661719220759, 0.510408881011984,
    0.474156661506339, 0.0634417222066936, 0.996813043510553,
    NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN), dim = 80L)), class = "data.frame",
    row.names = c(NA, 80L)), questiontypes = c("PickOne", "PickOne"),
    footerhtml = "Age by Preferred cola&lt;br /&gt;sample size = 322; total sample size = 327; 5 missing; 95% confidence level",
    name = "table.Age.by.Preferred.cola", questions = c("Age", "Preferred cola"))

tb.3d <- structure(c(3.54430379746835, 16.4556962025316, 14.9367088607595,
    6.58227848101266, 16.7088607594937, 9.11392405063291, 5.82278481012658,
    34.6835443037975, 19.2405063291139, 9.62025316455696, 26.8354430379747,
    18.7341772151899, 12.9113924050633, 22.0253164556962, 27.5949367088608,
    33.1645569620253, 42.7848101265823, 35.4430379746835, 47.0886075949367,
    20, 28.1012658227848, 43.5443037974684, 9.62025316455696, 21.2658227848101,
    30.6329113924051, 6.83544303797468, 10.126582278481, 7.08860759493671,
    4.05063291139241, 15.4430379746835, 100, 100, 100, 100, 100,
    100, 4.93827160493827, 11.6049382716049, 9.87654320987654, 10.3703703703704,
    16.2962962962963, 14.320987654321, 7.90123456790123, 24.9382716049383,
    19.5061728395062, 14.320987654321, 23.2098765432099, 15.3086419753086,
    16.2962962962963, 20.9876543209877, 23.2098765432099, 34.8148148148148,
    38.2716049382716, 25.9259259259259, 35.8024691358025, 27.1604938271605,
    23.4567901234568, 31.8518518518519, 16.5432098765432, 27.4074074074074,
    35.0617283950617, 15.3086419753086, 23.9506172839506, 8.64197530864197,
    5.67901234567901, 17.037037037037, 100, 100, 100, 100, 100, 100,
    4.25, 14, 12.375, 8.5, 16.5, 11.75, 6.875, 29.75, 19.375, 12,
    25, 17, 14.625, 21.5, 25.375, 34, 40.5, 30.625, 41.375, 23.625,
    25.75, 37.625, 13.125, 24.375, 32.875, 11.125, 17.125, 7.875,
    4.875, 16.25, 100, 100, 100, 100, 100, 100), statistic = "Column %",
    dim = c(6L, 6L, 3L), dimnames = list(c("Coca-Cola", "Diet Coke", "Coke Zero",
    "Pepsi", "Diet Pepsi", "Pepsi Max"), c("Hate", "Dislike", "Neither like nor dislike",
    "Like", "Love", "NET"), c("Male", "Female", "NET")), class = c("array", "QTable", "qTable"),
    dimnets = list(integer(0), 6L, 3L), dimduplicates = list(integer(0), 6L, 3L),
    span = list(rows = structure(list(c("Coca-Cola", "Diet Coke", "Coke Zero",
    "Pepsi", "Diet Pepsi", "Pepsi Max")), class = "data.frame", names = "",
    row.names = c(NA, 6L)), columns = structure(list(c("Hate", "Dislike", "Neither like nor dislike",
    "Like", "Love", "NET")), class = "data.frame", names = "", row.names = c(NA, 6L))),
    basedescriptiontext = "sample size = 800", basedescription = list(
    Minimum = 800L, Maximum = 800L, Range = FALSE, Total = 800L,
    Missing = 0L, EffectiveSampleSize = 800L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0, 0, 0, 0, 0, 0, 0,
    0, 0, 0.465295629820051, 0.465295629820051, 0, 0, 0, 0, 0,
    0, 0, 0.246786632390746, 0.246786632390746, 0, 0.465295629820051,
    0.465295629820051, 0, 0, 0, 0, 0.246786632390746, 0.246786632390746,
    0, 0.588688946015424, 0.588688946015424, 0, 0, 0, 0, 0.246786632390746,
    0.246786632390746, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0,
    0, 0, 0, 0, 0, 0, 0.246786632390746, 0.246786632390746, 0,
    0, 0, 0, 0.588688946015424, 0.588688946015424, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.465295629820051, 0.465295629820051,
    0, 0, 0, 0, 0, 0, 0, 0.246786632390746, 0.246786632390746,
    0, 0, 0, 0, 0.465295629820051, 0.465295629820051, 0, 0.246786632390746,
    0.246786632390746, 0, 0, 0, 0, 0, 0, 0), dim = 108L), significancedirection = structure(c("None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "Up", "Down", "None", "None", "None", "None", "None", "None",
    "None", "Up", "Down", "None", "Up", "Down", "None", "None",
    "None", "None", "Down", "Up", "None", "Down", "Up", "None",
    "None", "None", "None", "Up", "Down", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "Down",
    "Up", "None", "None", "None", "None", "None", "None", "None",
    "Down", "Up", "None", "None", "None", "None", "Up", "Down",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "Down", "Up", "None", "None", "None", "None", "None", "None",
    "None", "Down", "Up", "None", "None", "None", "None", "Up",
    "Down", "None", "Down", "Up", "None", "None", "None", "None",
    "None", "None", "None"), dim = 108L), significancefontsizemultiplier = structure(c(1,
    1, 1, 1, 1, 1, 1, 1, 1, 2.81, 0.355871886120996, 1, 1, 1,
    1, 1, 1, 1, 1.96, 0.510204081632653, 1, 2.81, 0.355871886120996,
    1, 1, 1, 1, 0.510204081632653, 1.96, 1, 0.303951367781155,
    3.29, 1, 1, 1, 1, 1.96, 0.510204081632653, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 0.204498977505112, 4.89, 1, 1, 1, 1, 1, 1,
    1, 0.510204081632653, 1.96, 1, 1, 1, 1, 3.29, 0.303951367781155,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.355871886120996,
    2.81, 1, 1, 1, 1, 1, 1, 1, 0.510204081632653, 1.96, 1, 1,
    1, 1, 2.81, 0.355871886120996, 1, 0.510204081632653, 1.96,
    1, 1, 1, 1, 1, 1, 1), dim = 108L), significanceissignificant = structure(c(FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE,
    TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE,
    TRUE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE,
    TRUE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE,
    TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE,
    TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE,
    TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE,
    TRUE, FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, FALSE, TRUE,
    TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), dim = 108L),
    significanceargbcolor = structure(c(0L, 0L, 0L, 0L, 0L, 0L,
    0L, 0L, 0L, -16776961L, -65536L, 0L, 0L, 0L, 0L, 0L, 0L,
    0L, -16776961L, -65536L, 0L, -16776961L, -65536L, 0L, 0L,
    0L, 0L, -65536L, -16776961L, 0L, -65536L, -16776961L, 0L,
    0L, 0L, 0L, -16776961L, -65536L, 0L, 0L, 0L, 0L, 0L, 0L,
    0L, 0L, 0L, 0L, -65536L, -16776961L, 0L, 0L, 0L, 0L, 0L,
    0L, 0L, -65536L, -16776961L, 0L, 0L, 0L, 0L, -16776961L,
    -65536L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
    0L, 0L, 0L, 0L, -65536L, -16776961L, 0L, 0L, 0L, 0L, 0L,
    0L, 0L, -65536L, -16776961L, 0L, 0L, 0L, 0L, -16776961L,
    -65536L, 0L, -65536L, -16776961L, 0L, 0L, 0L, 0L, 0L, 0L,
    0L), dim = 108L), zstatistic = structure(c(-0.977169614149642,
    0.977169614149642, NaN, -1.1615852872974, 1.1615852872974,
    NaN, -1.35460948532479, 1.35460948532479, NaN, 3.24052971793344,
    -3.24052971793344, NaN, -1.33319529269262, 1.33319529269262,
    NaN, NaN, NaN, NaN, 1.97686687766082, -1.97686687766082,
    NaN, 3.0144522782866, -3.0144522782866, NaN, 0.357176581849717,
    -0.357176581849717, NaN, -2.38375995854075, 2.38375995854075,
    NaN, -3.81055866641894, 3.81055866641894, NaN, NaN, NaN,
    NaN, 2.17299727089404, -2.17299727089404, NaN, -0.0950521966256294,
    0.0950521966256294, NaN, 1.42498871465585, -1.42498871465585,
    NaN, 1.50203798324233, -1.50203798324233, NaN, -5.18906164437283,
    5.18906164437283, NaN, NaN, NaN, NaN, -1.92079740961063,
    1.92079740961063, NaN, -2.04557227405644, 2.04557227405644,
    NaN, -0.492630671346596, 0.492630671346596, NaN, 3.4130537361886,
    -3.4130537361886, NaN, -0.815532566820322, 0.815532566820322,
    NaN, NaN, NaN, NaN, 0.157176521383107, -0.157176521383107,
    NaN, 1.18401254693903, -1.18401254693903, NaN, 1.30011015397555,
    -1.30011015397555, NaN, -2.89918291800969, 2.89918291800969,
    NaN, -1.06930606427569, 1.06930606427569, NaN, NaN, NaN,
    NaN, -2.2866392726549, 2.2866392726549, NaN, 1.28957319903202,
    -1.28957319903202, NaN, 2.91975695510422, -2.91975695510422,
    NaN, -2.02281655880286, 2.02281655880286, NaN, -0.611012418318008,
    0.611012418318008, NaN, NaN, NaN, NaN), dim = 108L), pcorrected = structure(c(0.328485188425889,
    0.328485188425889, NaN, 0.24540396119606, 0.24540396119606,
    NaN, 0.175542009795229, 0.175542009795229, NaN, 0.00119307835398608,
    0.00119307835398608, NaN, 0.182467723730427, 0.182467723730427,
    NaN, NaN, NaN, NaN, 0.0480566796881834, 0.0480566796881834,
    NaN, 0.00257443708241434, 0.00257443708241434, NaN, 0.720959616151671,
    0.720959616151671, NaN, 0.01713677624523, 0.01713677624523,
    NaN, 0.000138653102664699, 0.000138653102664699, NaN, NaN,
    NaN, NaN, 0.0297805226882373, 0.0297805226882373, NaN, 0.924273367650932,
    0.924273367650932, NaN, 0.154160463327892, 0.154160463327892,
    NaN, 0.133087299604457, 0.133087299604457, NaN, 0.000000211356425694476,
    0.000000211356425694476, NaN, NaN, NaN, NaN, 0.0547572531858919,
    0.0547572531858919, NaN, 0.0407984716486341, 0.0407984716486341,
    NaN, 0.622273572116004, 0.622273572116004, NaN, 0.000642392740369369,
    0.000642392740369369, NaN, 0.414767530919097, 0.414767530919097,
    NaN, NaN, NaN, NaN, 0.875105731519098, 0.875105731519098,
    NaN, 0.236408096146459, 0.236408096146459, NaN, 0.19356321801095,
    0.19356321801095, NaN, 0.00374136554760329, 0.00374136554760329,
    NaN, 0.284931778937184, 0.284931778937184, NaN, NaN, NaN,
    NaN, 0.0222168869601121, 0.0222168869601121, NaN, 0.197198886110578,
    0.197198886110578, NaN, 0.00350304469853324, 0.00350304469853324,
    NaN, 0.0430920638156442, 0.0430920638156442, NaN, 0.541191359109196,
    0.541191359109196, NaN, NaN, NaN, NaN), dim = 108L)), class = "data.frame",
    row.names = c(NA, 108L)), questiontypes = c("PickOneMulti", "PickOne"),
    footerhtml = "Brand attitude by Gender&lt;br /&gt;sample size = 800; 95% confidence level",
    name = "table.Brand.attitude.by.Gender", questions = c("Brand attitude", "Gender"))

tb.2d.colcmp <- structure(c("38.983050847457626", "43.07692307692308", "43.421052631578952",
    "37.333333333333336", "50", "49.230769230769234", "38.961038961038966",
    "54.54545454545454", "33.82352941176471", "15.254237288135593",
    "9.2307692307692317", "9.2105263157894726", "9.3333333333333339",
    "5", "16.923076923076923", "9.0909090909090917", "7.2727272727272725",
    "11.76470588235294", "16.949152542372879", "15.384615384615385",
    "17.105263157894736", "24", "10", "15.384615384615385", "18.181818181818183",
    "18.181818181818183", "19.117647058823529", "5.0847457627118651",
    "6.1538461538461542", "13.157894736842104", "10.666666666666668",
    "15", "4.6153846153846159", "7.7922077922077921", "12.727272727272727",
    "7.3529411764705888", "1.6949152542372881", "3.0769230769230771",
    "1.3157894736842104", "4", "5", "1.5384615384615385", "2.5974025974025974",
    "0", "4.4117647058823533", "22.033898305084744", "21.53846153846154",
    "13.157894736842104", "13.333333333333334", "13.333333333333334",
    "9.2307692307692317", "19.480519480519483", "5.4545454545454541",
    "22.058823529411764", "0", "0", "0", "1.3333333333333335", "0",
    "1.5384615384615385", "1.2987012987012987", "1.8181818181818181",
    "0", "0", "1.5384615384615385", "2.6315789473684208", "0", "1.6666666666666667",
    "1.5384615384615385", "2.5974025974025974", "0", "1.4705882352941175",
    NA, NA, NA, NA, NA, NA, NA, "i", NA, NA, NA, NA, NA, NA, "e",
    NA, NA, NA, NA, NA, NA, "e", NA, NA, NA, NA, NA, NA, NA, NA,
    NA, "f", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
    "f h", "h", NA, NA, NA, NA, "h", NA, "f h", NA, NA, NA, NA, NA,
    NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "TRUE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE", "FALSE",
    "FALSE"), dim = c(9L, 8L, 3L), dimnames = list(c("January 2019",
    "February 2019", "March 2019", "April 2019", "May 2019", "June 2019",
    "July 2019", "August 2019", "September 2019"), c("Coca-Cola",
    "Diet Coke", "Coke Zero", "Pepsi ", "Diet Pepsi", "Pepsi Max",
    "Dislike all cola", "Don't care"), c("Column %", "Column Comparisons",
    "signifDown#FF0000")), dimnets = list(9L, integer(0)), dimduplicates = list(
    9L, integer(0)), span = list(rows = structure(list(c("Coca-Cola",
    "Diet Coke", "Coke Zero", "Pepsi ", "Diet Pepsi", "Pepsi Max",
    "Dislike all cola", "Don't care", "NET")), class = "data.frame", names = "", row.names = c(NA,
    9L)), columns = structure(list(c("January 2019", "February 2019",
    "March 2019", "April 2019", "May 2019", "June 2019", "July 2019",
    "August 2019", "September 2019")), class = "data.frame", names = "", row.names = c(NA,
    9L))), basedescriptiontext = "sample size = 600", basedescription = list(
    Minimum = 600L, Maximum = 600L, Range = FALSE, Total = 600L,
    Missing = 0L, EffectiveSampleSize = 600L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.246786632390746,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0), dim = 72L), significancedirection = structure(c("None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None", "None",
    "None", "None", "None", "None", "Down", "None", "None", "None",
    "None", "None", "None", "None", "None", "None", "None"), dim = 72L),
    significancefontsizemultiplier = structure(c(1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    0.510204081632653, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), dim = 72L),
    significanceissignificant = structure(c(FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), dim = 72L), significanceargbcolor = structure(c(0L,
    0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
    0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
    0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
    0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
    -65536L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), dim = 72L),
    zstatistic = structure(c(-0.62940939465171, 1.30771213827245,
    -0.0820979640732077, -1.14429826122502, -0.48791370200115,
    1.41698650221033, -0.662689156363686, -0.940344824449766,
    0.0420292886376505, -0.309259841421185, -0.439539733218443,
    -0.891456850234788, 0.217418063691835, 1.37923526529083,
    -0.699459025197869, 0.152695485088389, 0.110796070487142,
    -0.344101181613611, -0.0562055260577112, 1.29031271719716,
    -0.782199407847154, -0.643857894117949, -0.764229228600978,
    1.05589089614984, -1.02902736318649, -0.304152137549518,
    1.6305311069985, 0.481270806739568, 0.766214166358196, -0.59431330862179,
    0.758461378391797, -1.07624400500126, 1.18252193228985, -1.43059718521731,
    -1.58179259849339, 1.65060371765894, 1.1825404121991, -0.524135071823079,
    -0.668900062090651, 0.237289498938125, 1.10382184369407,
    1.84836695919173, -0.439539733218443, -1.34666885886532,
    -0.597899675152548, -1.51173821654148, 0.914677186797214,
    0.152695485088389, -0.735488924238581, -0.383622726801171,
    0.210672562257823, -0.447686035258913, -0.0404075930422062,
    0.986157170814598, 0.72997694525888, 1.03582507100074, 1.84175520492246,
    -0.782402844149356, 0.17442010867758, 0.960183635619761,
    -1.28798939325587, -2.18618416836273, 1.10109933510165, -0.904571413489644,
    -1.5945099502312, 0.411804622465474, 0.412799558480715, -0.550449493622167,
    0.948590850574986, 1.54004621792839, -0.71743263988606, 0.104796682073794
    ), dim = 72L), pcorrected = structure(c(0.529081069077991,
    0.190970964705057, 0.934568812094859, 0.25249996415478, 0.62561096870991,
    0.156486873856842, 0.507529656063312, 0.347040714197406,
    0.966475349783375, 0.757123876479593, 0.660270498380656,
    0.372684130539631, 0.827882555085789, 0.167822228291424,
    0.48426521142497, 0.878638421389444, 0.911778061464483, 0.730770194307497,
    0.955178078966548, 0.196942103182332, 0.434097392457501,
    0.519667587785068, 0.444730651355972, 0.291018063862531,
    0.303466816781651, 0.761011987122148, 0.102989296274327,
    0.630324042553045, 0.443548880530325, 0.552302578915801,
    0.448174825533421, 0.281818144050729, 0.236998668309198,
    0.152545694655051, 0.113696925243825, 0.0988195192731426,
    0.236991340307815, 0.600184596515622, 0.503559230607115,
    0.812432208131742, 0.269670427356814, 0.0645492751467514,
    0.660270498380656, 0.178086906082229, 0.549906876652216,
    0.130600472374484, 0.360361124148833, 0.878638421389444,
    0.462041782894445, 0.70125809297648, 0.833142786226011, 0.654379801433826,
    0.967768176822535, 0.324055992571489, 0.465404277042016,
    0.300283759015127, 0.0655109651167772, 0.433977862854397,
    0.861535312096536, 0.336962801351165, 0.197749655422911,
    0.0288021340522304, 0.270853426392906, 0.3656924854246, 0.110821863904113,
    0.680482633024534, 0.679753474958007, 0.582011109542206,
    0.342828746201702, 0.123549087969988, 0.473107185803738,
    0.916537142875032), dim = 72L)), row.names = c(1L, 10L, 19L,
    28L, 37L, 46L, 55L, 64L, 2L, 11L, 20L, 29L, 38L, 47L, 56L, 65L,
    3L, 12L, 21L, 30L, 39L, 48L, 57L, 66L, 4L, 13L, 22L, 31L, 40L,
    49L, 58L, 67L, 5L, 14L, 23L, 32L, 41L, 50L, 59L, 68L, 6L, 15L,
    24L, 33L, 42L, 51L, 60L, 69L, 7L, 16L, 25L, 34L, 43L, 52L, 61L,
    70L, 8L, 17L, 26L, 35L, 44L, 53L, 62L, 71L, 9L, 18L, 27L, 36L,
    45L, 54L, 63L, 72L), class = "data.frame"),
    questiontypes = c("PickOne", "Date"),
    footerhtml = "Preferred cola by Interview Date&lt;br /&gt;sample size = 600; 95% confidence level; Significance: Compare to rest of data; Column comparison symbols: a, b, c... (confidence level &amp;gt;= 95%), A, B, C... (confidence level &amp;gt;= 99.9%); No test symbol: -; Not significant symbol: ", name = "table.Preferred.cola.by.Interview.Date", questions = c("Interview Date",
    "Preferred cola"), assigned.rownames = TRUE, "signif.annotations" = list(
    list(type = "Recolor text", data = "signifDown#FF0000", threstype = "above threshold",
    threshold = 0, color = "#FF0000"), list(type = "Arrow - down",
    data = "signifDown#FF0000", threstype = "above threshold",
    threshold = 0, color = "#FF0000", size = 12)))

tb.1row.colcmp <- structure(c("1750.060606060606", "1545.490243902439",
    "1639.6450617283951", NA, NA, NA), dim = c(1L, 3L, 2L),
    dimnames = list("Unique Identifier", c("I am on a diet, so I tend to watch what I eat and drink",
    "I tend watch what I eat and drink, but don’t consider myself",
    "I typically eat and drink whatever I feel like"), c("Average",
    "Column Comparisons")), dimnets = list(integer(0), 4L), dimduplicates = list(
    integer(0), 4L), span = list(rows = structure(list("Unique Identifier"),
    class = "data.frame", names = "", row.names = 1L), columns = structure(list(c("I am on a diet, so I tend to watch what I eat and drink",
    "I tend watch what I eat and drink, but don’t consider myself",
    "I typically eat and drink whatever I feel like", "NET")), class = "data.frame",
    names = "", row.names = c(NA, 4L))), basedescriptiontext = "sample size = 800",
    basedescription = list(Minimum = 800L, Maximum = 800L, Range = FALSE, Total = 800L,
    Missing = 0L, EffectiveSampleSize = 800L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0, 0, 0), dim = 3L),
    significancedirection = structure(c("None", "None", "None"
    ), dim = 3L), significancefontsizemultiplier = structure(c(1,
    1, 1), dim = 3L), significanceissignificant = structure(c(FALSE,
    FALSE, FALSE), dim = 3L), significanceargbcolor = structure(c(0L,
    0L, 0L), dim = 3L), zstatistic = structure(c(1.08712466405658,
    -1.42361851395793, 0.816659293062822), dim = 3L),
    pcorrected = structure(c(0.276981719101832, 0.154556933510948, 0.414123160385983),
    dim = 3L)), row.names = c(NA, 3L), class = "data.frame"), questiontypes = c("Number", "PickOne"),
    footerhtml = "Unique Identifier by Weight-consciousness&lt;br /&gt;sample size = 800; 95% confidence level; Column comparison symbols: a, b, c... (confidence level &amp;gt;= 95%), A, B, C... (confidence level &amp;gt;= 99.9%); No test symbol: -; Not significant symbol: ",
    name = "table.Unique.Identifier.by.Weight.consciousness.4",
    questions = c("Unique Identifier", "Weight-consciousness [Cola Tracking - January to December.sav]"),
    assigned.rownames = TRUE)


tb.1col.colcmp <- structure(c("2.7548209366391188", NA,
    "12.672176308539946", "18.457300275482094", "24.793388429752067",
    "15.977961432506888", "6.0606060606060606", "8.2644628099173563", "4.9586776859504136",
    NA, NA, "b", NA, NA, NA, NA, "b", NA, "FALSE", "FALSE", "TRUE",
    "FALSE", "FALSE", "FALSE", "FALSE", "TRUE", "FALSE", "FALSE",
    "TRUE", "FALSE", "FALSE", "FALSE", "FALSE", "TRUE", "FALSE",
    "FALSE"), dim = c(9L, 1L, 4L), dimnames = list(c("Less than $15,000",
    "$15,001 to $30,000", "$30,001 to $45,000", "$45,001 to $60,000",
    "$60,001 to $90,000", "$90,001 to $120,000", "$120,001 to $150,000",
    "$150,001 to $200,000", "$200,001 or more"), "Male", c("Column %",
    "Column Comparisons", "signifUp#0000FF", "signifDown#FF0000")), dimnets = list(
    10L, 3L), dimduplicates = list(10L, 3L), span = list(rows = structure(list(
    c("Less than $15,000", "$15,001 to $30,000", "$30,001 to $45,000",
    "$45,001 to $60,000", "$60,001 to $90,000", "$90,001 to $120,000",
    "$120,001 to $150,000", "$150,001 to $200,000", "$200,001 or more",
    "NET")), class = "data.frame", names = "", row.names = c(NA, 10L)),
    columns = structure(list(c("Male", "Female", "NET")), class = "data.frame",
    names = "", row.names = c(NA, 3L))),
    basedescriptiontext = "sample size = 707; total sample size = 800; 93 missing",
    basedescription = list(Minimum = 707L, Maximum = 707L, Range = FALSE, Total = 800L,
    Missing = 93L, EffectiveSampleSize = 707L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0, 0, 0, 0.74293059125964,
    0.74293059125964, 0, 0.246786632390746, 0.246786632390746,
    0), dim = 9L), significancedirection = structure(c("None",
    "None", "None", "Down", "Up", "None", "Up", "Down", "None"
    ), dim = 9L), significancefontsizemultiplier = structure(c(1,
    1, 1, 0.25706940874036, 3.89, 1, 1.96, 0.510204081632653,
    1), dim = 9L), significanceissignificant = structure(c(FALSE,
    FALSE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, FALSE), dim = 9L),
    significanceargbcolor = structure(c(0L, 0L, 0L, -65536L,
    -16776961L, 0L, -16776961L, -65536L, 0L), dim = 9L),
    zstatistic = structure(c(-0.767283305061572,
    0.767283305061572, NaN, -4.23524108526787, 4.23524108526787,
    NaN, 2.10660920367076, -2.10660920367076, NaN), dim = 9L),
    pcorrected = structure(c(0.442913092343004, 0.442913092343004,
    NaN, 0.0000228306627828578, 0.0000228306627828578, NaN, 0.0351514682974756,
    0.0351514682974756, NaN), dim = 9L)), row.names = c(NA, 9L), class = "data.frame"),
    questiontypes = c("PickOne", "PickOne"),
    footerhtml = "Income by Gender&lt;br /&gt;sample size = 707; total sample size = 800; 93 missing; 95% confidence level; Column comparison symbols: a, b, c... (confidence level &amp;gt;= 95%), A, B, C... (confidence level &amp;gt;= 99.9%); No test symbol: -; Not significant symbol: ", name = "table.Income.by.Gender.3",
    questions = c("Income", "Gender [Cola Tracking - January to December.sav]"), assigned.rownames = TRUE, signif.annotations = list(
    list(type = "Recolor text", data = "signifUp#0000FF", threstype = "above threshold",
    threshold = 0, color = "#0000FF"), list(type = "Arrow - up",
    data = "signifUp#0000FF", threstype = "above threshold",
    threshold = 0, color = "#0000FF", size = 12), list(type = "Recolor text",
    data = "signifDown#FF0000", threstype = "above threshold",
    threshold = 0, color = "#FF0000"), list(type = "Arrow - down",
    data = "signifDown#FF0000", threstype = "above threshold",
    threshold = 0, color = "#FF0000", size = 12)))

tb.multstats.colcmp <- structure(c("1750.060606060606", "1545.490243902439",
    "1639.6450617283951", "1.0871246640565793", "-1.4236185139579283",
    "0.81665929306282226", "143.05669060448602", "55.25686177497137",
    "61.796511355528594", NA, NA, NA), dim = c(1L, 3L, 4L),
    dimnames = list("Unique Identifier",
    c("I am on a diet, so I tend to watch what I eat and drink",
    "I tend watch what I eat and drink, but don’t consider myself",
    "I typically eat and drink whatever I feel like"), c("Average",
    "z-Statistic", "Standard Error", "Column Comparisons")), dimnets = list(
    integer(0), 4L), dimduplicates = list(integer(0), 4L), span = list(
    rows = structure(list("Unique Identifier"), class = "data.frame", names = "",
    row.names = 1L), columns = structure(list(c("I am on a diet, so I tend to watch what I eat and drink",
    "I tend watch what I eat and drink, but don’t consider myself",
    "I typically eat and drink whatever I feel like", "NET")), class = "data.frame",
    names = "", row.names = c(NA, 4L))), basedescriptiontext = "sample size = 800",
    basedescription = list(Minimum = 800L, Maximum = 800L, Range = FALSE, Total = 800L,
    Missing = 0L, EffectiveSampleSize = 800L, EffectiveSampleSizeProportion = 100,
    FilteredProportion = 0), QStatisticsTestingInfo = structure(list(
    significancearrowratio = structure(c(0, 0, 0), dim = 3L),
    significancedirection = structure(c("None", "None", "None"
    ), dim = 3L), significancefontsizemultiplier = structure(c(1,
    1, 1), dim = 3L), significanceissignificant = structure(c(FALSE,
    FALSE, FALSE), dim = 3L), significanceargbcolor = structure(c(0L,
    0L, 0L), dim = 3L), zstatistic = structure(c(1.08712466405658,
    -1.42361851395793, 0.816659293062822), dim = 3L),
    pcorrected = structure(c(0.276981719101832, 0.154556933510948, 0.414123160385983),
    dim = 3L)), row.names = c(NA, 3L), class = "data.frame"),
    questiontypes = c("Number", "PickOne"),
    footerhtml = "Unique Identifier by Weight-consciousness&lt;br /&gt;sample size = 800; 95% confidence level; Column comparison symbols: a, b, c... (confidence level &amp;gt;= 95%), A, B, C... (confidence level &amp;gt;= 99.9%); No test symbol: -; Not significant symbol: ", name = "table.Unique.Identifier.by.Weight.consciousness",
    questions = c("Unique Identifier", "Weight-consciousness [Cola Tracking - January to December.sav]"),
    assigned.rownames = TRUE)


test_that("stats testing added to data matrix",
{
    expect_error(res <- PrepareData("Column", input.data.table = tb.1d,
    tidy = FALSE, signif.append = TRUE), NA)
    expect_equal(dimnames(res$data), list(c("18 to 24", "25 to 29", "30 to 34",
    "35 to 39", "40 to 44", "45 to 49", "50 to 54", "55 to 64", "65 or more"),
    NULL, c("%","signifUp#0000FF", "signifDown#FF0000")))
    expect_equal(attr(res$data, "signif.annotations"),
    list(list(type = "Arrow - up", data = "signifUp#0000FF", threstype = "above threshold",
    threshold = 0, color = "#0000FF", size = 12), list(type = "Arrow - down",
    data = "signifDown#FF0000", threstype = "above threshold",
    threshold = 0, color = "#FF0000", size = 12)))
    expect_error(viz <- CChart("Column", res$data, append.data = TRUE, signif.show = FALSE), NA)
    expect_equal(names(attr(viz, "ChartData")), rownames(tb.1d)[-10])
    expect_equal(attr(attr(viz, "ChartData"), "statistic"), "%")

    expect_error(res <- PrepareData("Column", input.data.table = tb.1d.multstats,
        tidy = FALSE, signif.append = TRUE, row.names.to.remove = NULL), NA)
    expect_equal(dimnames(res$data), list(c("18 to 24", "25 to 29", "30 to 34",
        "35 to 39", "40 to 44", "45 to 49", "50 to 54", "55 to 64", "65 or more", "NET"),
        NULL, c("%", "Count", "signifUp#0000FF", "signifDown#FF0000")))
    expect_error(viz <- CChart("Bar", res$data, append.data = TRUE, signif.show = TRUE), NA)
    expect_equal(dimnames(attr(viz, "ChartData"))[[1]], dimnames(tb.1d.multstats)[[1]])
    expect_equal(dimnames(attr(viz, "ChartData"))[[3]], dimnames(tb.1d.multstats)[[2]])

    expect_error(res <- PrepareData("Column", input.data.table = tb.2d, signif.symbol = "Caret",
        tidy = FALSE, hide.empty.rows.and.columns = TRUE, signif.append = TRUE), NA)
    expect_equal(dimnames(res$data), list(c("18 to 24", "25 to 29", "30 to 34",
        "35 to 39", "40 to 44", "45 to 49", "50 to 54", "55 to 64", "65 or more"),
        c("Coca-Cola", "Diet Coke", "Coke Zero", "Pepsi", "Pepsi Light", "Pepsi Max"),
        c("Column %", "signifUp#0000FF", "signifDown#FF0000")))
    expect_equal(res$data[,,2],
        structure(c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0), .Dim = c(9L,
        6L), .Dimnames = list(c("18 to 24", "25 to 29", "30 to 34", "35 to 39",
        "40 to 44", "45 to 49", "50 to 54", "55 to 64", "65 or more"),
        c("Coca-Cola", "Diet Coke", "Coke Zero", "Pepsi", "Pepsi Light",
        "Pepsi Max"))))
    expect_error(viz <- CChart("Bar", res$data, append.data = TRUE, signif.show = TRUE), NA)
    expect_equal(rownames(attr(viz, "ChartData")), rownames(tb.2d)[1:9])
    expect_equal(colnames(attr(viz, "ChartData")), colnames(tb.2d)[1:6])
    expect_equal(attr(attr(viz, "ChartData"), "statistic"), attr(tb.2d, "statistic"))

    expect_error(res <- PrepareData("Column", input.data.table = tb.1d, signif.symbol = "None",
        tidy = FALSE, signif.append = TRUE, signif.colors.on.font = TRUE), NA)
    expect_error(CChart("Column", res$data, data.label.show = T, signif.show = TRUE), NA)

    expect_error(res <- PrepareData("Column", input.data.table = tb.2d.multstats,
        tidy = FALSE, signif.append = TRUE), NA)
    expect_equal(dimnames(res$data), list(c("18 to 24", "25 to 29", "30 to 34",
        "35 to 39", "40 to 44", "45 to 49", "50 to 54", "55 to 64", "65 or more"),
        c("Coca-Cola", "Diet Coke", "Coke Zero", "Pepsi", "Pepsi Light", "Pepsi Max"),
        c("Count", "Standard Error", "signifUp#0000FF", "signifDown#FF0000")))

    expect_error(res <- PrepareData("Column", input.data.table = tb.2d.multstats,
        as.percentages = TRUE, tidy = FALSE, signif.append = TRUE), NA)
    expect_equal(dimnames(res$data), list(c("18 to 24", "25 to 29", "30 to 34",
        "35 to 39", "40 to 44", "45 to 49", "50 to 54", "55 to 64", "65 or more"),
        c("Coca-Cola", "Diet Coke", "Coke Zero", "Pepsi", "Pepsi Light", "Pepsi Max"),
        c("%", "Standard Error", "signifUp#0000FF", "signifDown#FF0000")))
    expect_equal(res$values.title, "%")
    expect_error(viz <- CChart("Bar", res$data, append.data = TRUE, signif.show = TRUE), NA)
    expect_equal(dimnames(attr(viz, "ChartData"))[1:2], dimnames(res$data)[1:2])
    expect_equal(dimnames(attr(viz, "ChartData"))[[3]], dimnames(res$data)[[3]][1:2])

    expect_error(res <- PrepareData("Bar", input.data.table = tb.1d, as.percentages = TRUE,
        tidy = FALSE, signif.append = TRUE), NA)
    expect_equal(res$values.title, "%")
})

test_that("QStatisticsTestingInfo rearranges with data manipulations",
{
    expect_error(res <- PrepareData("Column", input.data.table = tb.1d,
        tidy = FALSE, signif.append = TRUE, sort.rows = TRUE), NA)
    expect_equal(attr(res$data, "QStatisticsTestingInfo")$pcorrected,
                 attr(tb.1d, "QStatisticsTestingInfo")$pcorrected[order(tb.1d)[-10]])

    orig.pcorr <- structure(attr(tb.2d, "QStatisticsTestingInfo")$pcorrected,
        names = paste(rep(colnames(tb.2d), nrow(tb.2d)), "-", rep(rownames(tb.2d), each=ncol(tb.2d))))
    expect_warning(res <- PrepareData("Column", input.data.table = tb.2d, signif.symbol = "Caret",
        tidy = FALSE, hide.empty.rows.and.columns = TRUE, sort.rows = TRUE, signif.append = TRUE),
        "Table has been sorted")
    new.pcorr <- structure(attr(res$data, "QStatisticsTestingInfo")$pcorrected,
        names = paste(rep(colnames(res$data), nrow(res$data)), "-", rep(rownames(res$data), each=ncol(res$data))))
    expect_equal(orig.pcorr[names(new.pcorr)], new.pcorr)

    expect_warning(res <- PrepareData("Column", input.data.table = tb.2d, signif.symbol = "Caret",
        tidy = FALSE, hide.empty.rows.and.columns = TRUE, sort.columns = TRUE, transpose = TRUE,
        signif.append = TRUE), "Table has been sorted")
    new.pcorr <- structure(attr(res$data, "QStatisticsTestingInfo")$pcorrected,
        names = paste(rep(rownames(res$data), each=ncol(res$data)), "-", rep(colnames(res$data), nrow(res$data))))
    expect_equal(orig.pcorr[names(new.pcorr)], new.pcorr)

    expect_error(res <- PrepareData("Column", input.data.table = tb.2d.multstats, signif.symbol = "Caret",
        tidy = FALSE, sort.rows = TRUE, sort.rows.decreasing = TRUE, transpose = TRUE,
        signif.append = TRUE), NA)
    new.pcorr <- structure(attr(res$data, "QStatisticsTestingInfo")$pcorrected,
        names = paste(rep(rownames(res$data), each=ncol(res$data)), "-", rep(colnames(res$data), nrow(res$data))))
    expect_equal(orig.pcorr[names(new.pcorr)], new.pcorr)

    expect_error(res <- PrepareData("Column", input.data.table = tb.3d, signif.symbol = "Caret",
        tidy = FALSE, row.names.to.remove = "Pepsi", transpose = FALSE, signif.append = TRUE), NA)
    expect_equal(attr(res$data, "QStatisticsTestingInfo")$pcorrected,
        structure(c(0.328485188425889, 0.328485188425889, NaN, 0.24540396119606,
           0.24540396119606, NaN, 0.175542009795229, 0.175542009795229,
           NaN, 0.00119307835398608, 0.00119307835398608, NaN, 0.182467723730427,
           0.182467723730427, NaN, NaN, NaN, NaN, 0.0480566796881834, 0.0480566796881834,
           NaN, 0.00257443708241434, 0.00257443708241434, NaN, 0.720959616151671,
           0.720959616151671, NaN, 0.01713677624523, 0.01713677624523, NaN,
           0.000138653102664699, 0.000138653102664699, NaN, NaN, NaN, NaN,
           0.0297805226882373, 0.0297805226882373, NaN, 0.924273367650932,
           0.924273367650932, NaN, 0.154160463327892, 0.154160463327892,
           NaN, 0.133087299604457, 0.133087299604457, NaN, 0.000000211356425694476,
           0.000000211356425694476, NaN, NaN, NaN, NaN, 0.875105731519098,
           0.875105731519098, NaN, 0.236408096146459, 0.236408096146459,
           NaN, 0.19356321801095, 0.19356321801095, NaN, 0.00374136554760329,
           0.00374136554760329, NaN, 0.284931778937184, 0.284931778937184,
           NaN, NaN, NaN, NaN, 0.0222168869601121, 0.0222168869601121, NaN,
           0.197198886110578, 0.197198886110578, NaN, 0.00350304469853324,
           0.00350304469853324, NaN, 0.0430920638156442, 0.0430920638156442,
           NaN, 0.541191359109196, 0.541191359109196, NaN, NaN, NaN, NaN), dim = 90L))


    expect_error(res <- PrepareData("Column", input.data.table = tb.3d, signif.symbol = "Caret",
        tidy = FALSE, select.columns = "1,4", column.labels = "Hate, Dislike", signif.append = TRUE), NA)
    expect_equal(attr(res$data, "QStatisticsTestingInfo")$significancedirection,
        structure(c("None", "None", "Up", "Up", "Up", "None", "None", "Down", "None", "None",
        "Down", "None"), dim = 12L))

    res <- PrepareData("Column", input.data.table = tb.2d, select.columns = "2",
        tidy = FALSE, signif.symbol = "Caret", signif.append = TRUE)
    expect_equal(attr(res$data, "QStatisticsTestingInfo")$significancedirection,
        structure(c("Down", "None", "None", "None", "Up", "None", "None",
        "None", "None"), dim = 9L))
})

test_that("Handle Column Comparisons correctly",
{
    expect_error(viz <- CChart("Line", tb.2d.colcmp,
              legend.orientation = "Horizontal", legend.x.position = 0.5,
              legend.y.position = 1.2, data.label.show = FALSE,
              signif.show = TRUE, append.data = TRUE), NA)
    chart.data <- attr(viz, "ChartData")
    expect_true(is.numeric(chart.data))
    expect_equal(dimnames(chart.data), list(c("January 2019", "February 2019",
        "March 2019", "April 2019", "May 2019", "June 2019", "July 2019",
        "August 2019", "September 2019"), c("Coca-Cola", "Diet Coke", "Coke Zero",
        "Pepsi ", "Diet Pepsi", "Pepsi Max", "Dislike all cola", "Don't care")))
    expect_equal(attr(chart.data, "statistic"), "Column %")
    chart.settings <- attr(viz, "ChartSettings")
    expect_equal(chart.settings$Legend$Position, "Top")
    chart.labels <- attr(viz, "ChartLabels")
    expect_equal(chart.labels$SeriesLabels[[1]]$ShowValue, FALSE)
    expect_equal(chart.labels$SeriesLabels[[6]]$CustomPoints,
        list(list(Index = 7, Segments = list(list(Font = list(color = "#FF0000",
        size = 9.00225056264066), Text = "↓")), Font = list(color = "#FF0000"))))

    expect_error(viz <- CChart("Column", tb.1row.colcmp, append.data = TRUE), NA)
    chart.data <- attr(viz, "ChartData")
    expect_true(is.numeric(chart.data))
    expect_equal(colnames(chart.data), colnames(tb.1row.colcmp))
    expect_equal(attr(chart.data, "statistic"), "Average")

    expect_warning(viz <- CChart("Column", tb.1col.colcmp, append.data = TRUE),
        "Missing values have been set to zero")
    chart.data <- attr(viz, "ChartData")
    expect_true(is.numeric(chart.data))
    expect_equal(names(chart.data), rownames(tb.1col.colcmp))
    expect_equal(attr(chart.data, "statistic"), "Column %")

    expect_error(viz <- CChart("Column", tb.multstats.colcmp, append.data = TRUE), NA)
    chart.data <- attr(viz, "ChartData")
    expect_true(is.numeric(chart.data))
    expect_equal(dimnames(chart.data)[1:2], dimnames(tb.multstats.colcmp)[1:2])
    expect_equal(dimnames(chart.data)[[3]], dimnames(tb.multstats.colcmp)[[3]][-4])

    expect_error(viz <- CChart("Bar", tb.2d.colcmp, data.label.show = FALSE,
            signif.show = TRUE, signif.column.comparisons = TRUE), NA)
    expect_error((viz <- CChart("Column", tb.2d.colcmp[,,1,drop=FALSE],
            signif.show = TRUE, signif.column.comparisons = TRUE,
            data.label.show = TRUE)), NA)
})
